WINDOWS SUBSYSTEM FOR LINUX

oc login *************************

cd /mnt/c/work/bcparks.ca/tools/syncdb

pwsh backup-db.ps1 -Project 61d198-prod -OutputPath ./



POWERSHELL

C:
cd \work\bcparks.ca\tools\syncdb
docker cp backup.sql postgres-docker:/tmp/backup.sql


DOCKER TERMINAL  (postgres-docker)

psql -U postgres
create database backup
create database strapi4
\q
cd /tmp
psql -U postgres -d backup < backup.sql

psql -U postgres -d backup

alter table protected_areas drop column search_text;
alter table public_advisories drop column search_text;

delete from public_advisory_audits__protected_areas 
where id in 
(select max(id) 
from public_advisory_audits__protected_areas
group by public_advisory_audit_id, "protected-area_id" 
having count(*) > 1);


-- RUN THIS REPEATEDLY UNTIL IT UPDATES 0 ROWS
delete from fire_zones_protected_areas__protected_areas_fire_zones 
where id in 
(select max(id) 
from fire_zones_protected_areas__protected_areas_fire_zones 
group by "fire-zone_id", "protected-area_id" 
having count(*) > 1);


POWERSHELL

git checkout f392b1d0c2fa2213f58beb017a3273a73c86bf0d   

cd  \work\bcparks.ca\src\cms

make sure you have the strapi4 .env file and the DATABASE_NAME is set to 'strapi4'

yarn bunvm use 18.14.2
rmdir node_modules
del yarn.lock

yarn
yarn build
yarn develop

shut down strapi (ctrl-c)


WINDOWS SUBSYSTEM FOR LINUX


cd /mnt/c/work/migration-scripts/v3-sql-v4-sql

make sure the .env settings are right  

DATABASE_V3_DATABASE=backup
DATABASE_V4_DATABASE=strapi4

yarn add tar
yarn
yarn start


DOCKER TERMIMAL


psql -U postgres -d strapi4

delete from up_permissions_role_links where permission_id in (select id from up_permissions where action in ('api::access-status.access-status.count',
'api::advisory-status.advisory-status.count',
'api::asset-type.asset-type.count',
'api::facility-type.facility-type.count',
'api::fire-ban-prohibition.fire-ban-prohibition.count',
'api::fire-centre.fire-centre.count',
'api::fire-zone.fire-zone.count',
'api::link.link.count',
'api::link-type.link-type.count',
'api::management-area.management-area.count',
'api::page.page.count',
'api::park-access-status.park-access-status.count',
'api::park-activity.park-activity.count',
'api::park-name.park-name.count',
'api::park-name-type.park-name-type.count',
'api::park-operation.park-operation.count',
'api::park-photo.park-photo.count',
'api::region.region.count',
'api::section.section.count',
'api::site.site.count',
'api::standard-message.standard-message.count',
'api::urgency.urgency.count',
'api::event-type.event-type.count',
'api::park-facility.park-facility.count',
'plugin::content-type-builder.builder.getReservedNames',
'api::website.website.count',
'api::menu.menu.count',
'api::park-operation-sub-area-date.park-operation-sub-area-date.count',
'api::park-operation-sub-area-type.park-operation-sub-area-type.count',
'api::park-operation-sub-area.park-operation-sub-area.count',
'api::activity-type.activity-type.count'));


delete from up_permissions where id in (select id from up_permissions where action in ('api::access-status.access-status.count',
'api::advisory-status.advisory-status.count',
'api::asset-type.asset-type.count',
'api::facility-type.facility-type.count',
'api::fire-ban-prohibition.fire-ban-prohibition.count',
'api::fire-centre.fire-centre.count',
'api::fire-zone.fire-zone.count',
'api::link.link.count',
'api::link-type.link-type.count',
'api::management-area.management-area.count',
'api::page.page.count',
'api::park-access-status.park-access-status.count',
'api::park-activity.park-activity.count',
'api::park-name.park-name.count',
'api::park-name-type.park-name-type.count',
'api::park-operation.park-operation.count',
'api::park-photo.park-photo.count',
'api::region.region.count',
'api::section.section.count',
'api::site.site.count',
'api::standard-message.standard-message.count',
'api::urgency.urgency.count',
'api::event-type.event-type.count',
'api::park-facility.park-facility.count',
'plugin::content-type-builder.builder.getReservedNames',
'api::website.website.count',
'api::menu.menu.count',
'api::park-operation-sub-area-date.park-operation-sub-area-date.count',
'api::park-operation-sub-area-type.park-operation-sub-area-type.count',
'api::park-operation-sub-area.park-operation-sub-area.count',
'api::activity-type.activity-type.count'));

\q


pg_dump -F t -U postgres -d strapi4 > /tmp/restore.tar



POWERSHELL


cd \work\bcparks.ca\tools\syncdb
docker cp postgres-docker:/tmp/restore.tar restore.tar
oc rsh main-patroni-0
patronictl list  (make sure you are on the Leader)
exit
oc cp restore.tar main-patroni-0:/tmp/restore.tar
oc rsh main-patroni-0
psql -U postgres

-- kill all db connections because with (force) isn't working
SELECT pg_terminate_backend(pg_stat_activity.pid)
FROM pg_stat_activity
WHERE pg_stat_activity.datname = 'cms' AND pid <> pg_backend_pid();

-- do this very quickly after the previous command 
drop database cms;

-- Wait for the deployment to turn red, then pause rollouts


create database cms;
\q
cd /tmp
pg_restore -U postgres -d cms restore.tar


RESTART PATRONI

patronictl restart main-patroni

psql -U postgres

\du   to get the username
user_86E6eDQWcf

\connect cms

GRANT ALL PRIVILEGES ON DATABASE cms TO "user_86E6eDQWcf";
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO "user_86E6eDQWcf";
CREATE EXTENSION pg_trgm;


SELECT 'ALTER TABLE public."' || tablename ||'" OWNER TO "user_86E6eDQWcf";'
FROM pg_tables WHERE NOT schemaname IN ('pg_catalog', 'information_schema')
ORDER BY schemaname, tablename;

 ALTER TABLE public."access_statuses" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."activity_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."admin_permissions" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."admin_permissions_role_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."admin_roles" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."admin_users" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."admin_users_roles_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."advisory_statuses" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."asset_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."business_hours" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_card_sets" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_card_sets_components" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_fancy_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_html_areas" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_images" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_link_cards" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_page_headers" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_page_sections" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_seos" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."event_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."facility_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."files" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."files_folder_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."files_related_morphs" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_ban_prohibitions" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_ban_prohibitions_fire_centre_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_ban_prohibitions_fire_zone_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_centres" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_zones" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_zones_fire_centre_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."fire_zones_protected_areas_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."legacy_redirects" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."link_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."links_public_advisory_audit_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."links_public_advisory_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."links_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."management_areas" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."management_areas_protected_areas_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."management_areas_region_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."management_areas_section_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."menus" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."menus_parent_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."pages" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."pages_components" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_access_statuses" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_access_statuses-cache" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_activities" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_activities_activity_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_activities_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_activities_site_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_facilities" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_facilities_facility_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_facilities_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_facilities_site_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_name_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_names" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_names_park_name_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_names_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_area_dates" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_area_dates_park_operation_sub_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_area_types" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_areas" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_areas_facility_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_areas_park_sub_area_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operation_sub_areas_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operations" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operations_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_operations_site_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_photos" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_sub_pages" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_sub_pages_components" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."park_sub_pages_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."protected_areas" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."protected_areas_components" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_access_status_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_advisory_status_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_event_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_fire_centres_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_fire_zones_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_management_areas_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_protected_areas_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_regions_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_sections_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_sites_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_standard_messages_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisories_urgency_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_access_status_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_advisory_status_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_event_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_fire_centres_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_fire_zones_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_management_areas_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_protected_areas_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_regions_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_sections_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_sites_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_standard_messages_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."public_advisory_audits_urgency_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."regions" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."sections" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."sections_region_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."sites" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."sites_protected_area_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."standard_messages" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."standard_messages_event_type_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."statutory_holidays" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_api_token_permissions" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_api_token_permissions_token_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_api_tokens" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_core_store_settings" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_database_schema" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_ee_store_settings" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_migrations" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."strapi_webhooks" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."up_permissions" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."up_permissions_role_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."up_roles" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."up_users" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."up_users_role_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."upload_folders" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."upload_folders_parent_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."urgencies" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."websites" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."websites_homepage_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."protected_areas_park_photos_links" OWNER TO "user_86E6eDQWcf";
 ALTER TABLE public."components_parks_link_cards_access_status_links" OWNER TO "user_86E6eDQWcf";


SELECT 'ALTER SEQUENCE public."' || sequence_name ||'" OWNER TO "user_86E6eDQWcf";'
FROM information_schema.sequences WHERE NOT sequence_schema IN ('pg_catalog', 'information_schema')
ORDER BY sequence_schema, sequence_name;

ALTER SEQUENCE public."access_statuses_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."activity_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."admin_permissions_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."admin_permissions_role_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."admin_roles_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."admin_users_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."admin_users_roles_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."advisory_statuses_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."asset_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."business_hours_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_card_sets_components_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_card_sets_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_fancy_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_html_areas_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_images_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_link_cards_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_page_headers_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_page_sections_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_seos_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."event_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."facility_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."files_folder_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."files_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."files_related_morphs_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_ban_prohibitions_fire_centre_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_ban_prohibitions_fire_zone_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_ban_prohibitions_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_centres_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_zones_fire_centre_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_zones_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."fire_zones_protected_areas_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."legacy_redirects_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."link_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."links_public_advisory_audit_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."links_public_advisory_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."links_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."management_areas_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."management_areas_protected_areas_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."management_areas_region_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."management_areas_section_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."menus_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."menus_parent_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."pages_components_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."pages_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_access_statuses-cache_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_access_statuses_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_activities_activity_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_activities_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_activities_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_activities_site_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_facilities_facility_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_facilities_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_facilities_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_facilities_site_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_name_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_names_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_names_park_name_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_names_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_area_dates_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_area_dates_park_operation_sub_area_li_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_area_types_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_areas_facility_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_areas_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_areas_park_sub_area_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operation_sub_areas_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operations_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operations_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_operations_site_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_photos_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_sub_pages_components_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_sub_pages_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."park_sub_pages_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."protected_areas_components_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."protected_areas_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_access_status_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_advisory_status_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_event_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_fire_centres_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_fire_zones_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_management_areas_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_protected_areas_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_regions_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_sections_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_sites_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_standard_messages_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisories_urgency_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_access_status_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_advisory_status_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_event_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_fire_centres_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_fire_zones_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_management_areas_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_protected_areas_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_regions_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_sections_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_sites_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_standard_messages_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."public_advisory_audits_urgency_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."regions_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."sections_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."sections_region_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."sites_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."sites_protected_area_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."standard_messages_event_type_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."standard_messages_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."statutory_holidays_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_api_token_permissions_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_api_token_permissions_token_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_api_tokens_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_core_store_settings_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_database_schema_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_ee_store_settings_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_migrations_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."strapi_webhooks_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."up_permissions_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."up_permissions_role_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."up_roles_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."up_users_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."up_users_role_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."upload_folders_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."upload_folders_parent_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."urgencies_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."websites_homepage_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."websites_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."components_parks_link_cards_access_status_links_id_seq" OWNER TO "user_86E6eDQWcf";
ALTER SEQUENCE public."protected_areas_park_photos_links_id_seq" OWNER TO "user_86E6eDQWcf";


RESUME ROLLOUTS IN OPENSHIFT


Add an API token for gatsby and update the github secrets (Unlimited / Full Access)

Change the email address fo "apiuser" in the "Users" collection to match the secret generated by the server (or change it to api@api.com for local development)

Change the default sort field for Park Operations to "orcsSiteNumber" to fix the 500 error

Enable all permissions in the Upload plugin for the API user (user-permission plugin settings)

